tinymce.PluginManager.add('ai-llm', function (editor, url) {
	var pluginName = '大语言模型';
	var baseURL = tinymce.baseURL;
	console.error(pluginName);
	var editorid = editor.id;
	//console.error(editor);
	var iframe1 = baseURL + '/plugins/ai-llm/index.html?editorid=' + editorid;
	var openDialog = function () {
		return editor.windowManager.openUrl({
			title: '大语言模型',
			size: 'large',
			width: 500,
			height: 300,
			url: iframe1,
			buttons: [

			],
			onAction: function (api, details) {
				switch (details.name) {
					case 'save':
						html = '1';
						console.log(html);
						editor.insertContent(html);
						api.close();
						break;
					default:
						break;
				}

			}
		});
	};

	editor.ui.registry.getAll().icons.aillm || editor.ui.registry.addIcon('aillm', '<svg class="icon" width="200px" height="200.00px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path fill="#333333" d="M540.444 3.755c315.79 0 496.072 239.331 478.891 492.089-11.15 163.84-79.644 286.947-179.086 356.238a28.444 28.444 0 0 1-32.54-46.706c85.219-59.278 144.895-166.684 154.851-313.344C977.636 269.653 820.224 60.644 540.444 60.644c-166.798 0-315.733 124.586-363.86 286.321a356.75 356.75 0 0 0-10.127 52.566l-2.845 23.78-2.446 26.908c-0.74 9.443-1.479 19.456-2.105 29.923a28.444 28.444 0 0 1-3.64 12.174l-2.333 3.584-78.165 99.84a28.444 28.444 0 0 0 9.955 43.122l4.836 1.82 91.818 25.487a28.444 28.444 0 0 1 20.196 21.163l0.626 5.233 8.931 243.2a28.444 28.444 0 0 0 23.439 26.966l4.949 0.398h168.79a28.444 28.444 0 0 1 5.12 56.434l-5.12 0.455h-168.79a85.333 85.333 0 0 1-84.594-74.183l-0.683-7.965-8.135-222.492-71.737-19.911a85.333 85.333 0 0 1-61.269-96.996l1.82-7.964a85.333 85.333 0 0 1 10.24-22.927l4.78-6.883 72.703-93.013 0.683-8.875c3.755-51.997 9.102-91.591 16.156-119.24l2.447-8.817C177.038 146.034 347.022 3.755 540.444 3.755z m173.227 252.473a85.333 85.333 0 1 1-68.38 136.305l-48.754 27.762a114.404 114.404 0 0 1-4.324 58.027l119.24 71.282a56.889 56.889 0 1 1-25.828 54.556l-0.228-3.868-124.814-74.468a113.778 113.778 0 1 1 11.72-157.298l56.32-31.971 0.113-3.243a85.333 85.333 0 0 1 84.935-77.084z m-228.978 128a56.889 56.889 0 1 0 0 113.777 56.889 56.889 0 0 0 0-113.777z m229.035-71.112a28.444 28.444 0 1 0 0 56.89 28.444 28.444 0 0 0 0-56.89z" /></svg>');

	console.error(editor.ui.registry.getAll().icons.aillm);
	editor.ui.registry.addButton('ai-llm', {
		icon: 'aillm',
		tooltip: pluginName,
		onAction: function () {
			openDialog();
		}
	});
	editor.ui.registry.addMenuItem('ai-llm', {
		text: pluginName,
		onAction: function () {
			openDialog();
		}
	});
	return {
		getMetadata: function () {
			return {
				name: pluginName,
				url: "https://gitee.com/weishakeji/LearningSystem",
			};
		}
	};
});
//接收来自内容页的调用
window.ai_llm_action = function (id, txt) {
	var editor = tinyMCE.editors[id];
	if (txt != '') {
		txt = '<span class="ai-llm">' + txt + '</span>';
		editor.insertContent(txt);		
		editor.windowManager.close();
	}
	console.log(txt);
}
