<!DOCTYPE html>
<html lang="en">

<head resource>
    <meta charset="UTF-8">
    <include file="../inc/meta.inc" />
    <title>成绩导出</title>
</head>

<body>
    <div id="vapp" v-cloak>
        <el-form ref="exportquery" :model="exportquery" @submit.native.prevent label-width="100px">
            <el-form-item label="导出范围" prop="scope">
                <el-radio v-model="exportquery.scope" :label="1">所有参考学员</el-radio>
                <el-radio v-model="exportquery.scope" :label="2" :disabled="sorts.length<1">按学员组导出
                    <span v-if="sorts.length<1">（没有学员组）</span>
                </el-radio>
            </el-form-item>
            <el-form-item label="学员组" prop="sorts" v-if="exportquery.scope==2">
                <el-checkbox-group v-model="exportquery.sorts" class="exportquery_sorts">
                    <el-checkbox v-for="(item,i) in sorts" :key="item.Sts_ID" :label="item.Sts_ID" :value="item.Sts_ID">
                        <span>{{i+1}}. {{item.Sts_Name}}</span>
                        <span class="sortcount" title="参考学员数量">（{{item.Sts_Count}}） </span>
                    </el-checkbox>
                </el-checkbox-group>
            </el-form-item>
            <template v-if="files.length>0">
                <el-divider content-position="left">文件下载</el-divider>               
                    <dl v-if="files.length>0" class="files">
                        <dd v-for="(f,i) in files">
                            <a :href="f.url" :filetype="f.type"  target="_blank" title="点击下载" :download="f.file">
                                {{f.file}}</a>
                            <span> {{f.size|size}}</span>
                            <el-popconfirm title="确定删除这个文件吗？" @confirm="deleteFile(f.file)">
                                <el-link type="danger" icon="el-icon-delete" v-loading="fileloading" slot="reference">删除
                                </el-link>
                            </el-popconfirm>
                        </dd>
                    </dl>
               
            </template>
        </el-form>
        <div class="footer">
            <el-button type="primary" @click="toexcel" :loading="fileloading">生成导出文件</el-button>
            <el-button type='close' :disabled="fileloading">取 消</el-button>
        </div>
    </div>
</body>

</html>